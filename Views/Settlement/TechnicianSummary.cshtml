@model IEnumerable<radio_waves.Models.TechnicianSettlement>

@{
    var culture = System.Globalization.CultureInfo.CurrentCulture.Name;
    var isArabic = culture.StartsWith("ar");

    ViewData["Title"] = isArabic ? "ملخص الفنيين" : "Technician Summary";

    string pageTitle = isArabic ? "ملخص الفنيين" : "Technician Summary";
    string createNewLabel = isArabic ? "إنشاء جديد" : "Create New";
    string runSettlementLabel = isArabic ? "تشغيل تسوية نهاية اليوم" : "Run End of Day Settlement";

    string technicianIdLabel = isArabic ? "معرف الفني" : "Technician ID";
    string technicianNameLabel = isArabic ? "اسم الفني" : "Technician Name";
    string totalFromReservationsLabel = isArabic ? "الإجمالي من الحجوزات" : "Total From Reservations";
    string totalFromInsuranceLabel = isArabic ? "الإجمالي من التأمين" : "Total From Insurance";
    string totalDebtShareLabel = isArabic ? "حصة الدين الكلية" : "Total Debt Share";
    string totalExpensesLabel = isArabic ? "الإجمالي للمصاريف" : "Total Expenses";
    string netPayableLabel = isArabic ? "الصافي المستحق" : "Net Payable";
    string settlementDateLabel = isArabic ? "تاريخ التسوية" : "Settlement Date";
    string editLabel = isArabic ? "تعديل" : "Edit";
    string detailsLabel = isArabic ? "تفاصيل" : "Details";
    string deleteLabel = isArabic ? "حذف" : "Delete";
}

<div class="container mt-4" dir="@(isArabic ? "rtl" : "ltr")">
    <h1 class="mb-4 @(isArabic ? "text-end" : "text-start")">@pageTitle</h1>

    <p>
        <a asp-action="Create" class="btn btn-primary">
            <i class="bi bi-plus-circle"></i> @createNewLabel
        </a>
    </p>

    <form asp-action="TechniciansSettlement" method="post">
        @Html.AntiForgeryToken()

        <button type="submit" class="btn btn-success mb-3">
            <i class="bi bi-check-circle-fill"></i> @runSettlementLabel
        </button>

        <table class="table table-bordered table-striped">
            <thead class="table-dark">
                <tr>
                    <th>@technicianIdLabel</th>
                    <th>@technicianNameLabel</th>
                    <th>@totalFromReservationsLabel</th>
                    <th>@totalFromInsuranceLabel</th>
                    <th>@totalDebtShareLabel</th>
                    <th>@totalExpensesLabel</th>
                    <th>@netPayableLabel</th>
                    <th>@settlementDateLabel</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                @for (int i = 0; i < Model.Count(); i++)
                {
                    var item = Model.ElementAt(i);
                    <tr>
                        <td>
                            @item.TechnicianId
                            <input type="hidden" name="Settlements[@i].TechnicianId" value="@item.TechnicianId" />
                        </td>
                        <td>
                            @item.TechnicianName
                            <input type="hidden" name="Settlements[@i].TechnicianName" value="@item.TechnicianName" />
                        </td>
                        <td>
                            @item.TotalFromReservations
                            <input type="hidden" name="Settlements[@i].TotalFromReservations" value="@item.TotalFromReservations" />
                        </td>
                        <td>
                            @item.TotalFromInsurance
                            <input type="hidden" name="Settlements[@i].TotalFromInsurance" value="@item.TotalFromInsurance" />
                        </td>
                        <td>
                            @item.TotalDebtShare
                            <input type="hidden" name="Settlements[@i].TotalDebtShare" value="@item.TotalDebtShare" />
                        </td>
                        <td>
                            @item.TotalExpenses
                            <input type="hidden" name="Settlements[@i].TotalExpenses" value="@item.TotalExpenses" />
                        </td>
                        <td>
                            @item.NetPayable
                            <input type="hidden" name="Settlements[@i].NetPayable" value="@item.NetPayable" />
                        </td>
                        <td>
                            @item.SettelmentDate.ToString("yyyy-MM-dd")
                            <input type="hidden" name="Settlements[@i].SettelmentDate" value="@item.SettelmentDate.ToString("yyyy-MM-dd")" />
                        </td>
                        <td>
                            <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-sm btn-outline-primary">@editLabel</a>
                            <a asp-action="Details" asp-route-id="@item.Id" class="btn btn-sm btn-outline-info">@detailsLabel</a>
                            <a asp-action="Delete" asp-route-id="@item.Id" class="btn btn-sm btn-outline-danger">@deleteLabel</a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </form>
</div>
