@model IEnumerable<radio_waves.Models.TechnicianSettlement>

@{
    var culture = System.Globalization.CultureInfo.CurrentCulture.Name;
    var isArabic = culture.StartsWith("ar");

    ViewData["Title"] = isArabic ? "تاريخ تسوية الفنيين" : "Technicians Settlement History";

    string pageTitle = isArabic ? "تاريخ تسوية الفنيين" : "Technicians Settlement History";
    string finalizeLabel = isArabic ? "اعتماد تسوية الفنيين" : "Finalize Technician Settlement";
    string technicianNameLabel = isArabic ? "اسم الفني" : "Technician Name";
    string totalFromReservationsLabel = isArabic ? "الإجمالي من الحجوزات" : "Total From Reservations";
    string totalFromInsuranceLabel = isArabic ? "الإجمالي من التأمين" : "Total From Insurance";
    string totalDebtShareLabel = isArabic ? "حصة الدين الكلية" : "Total Debt Share";
    string totalExpensesLabel = isArabic ? "الإجمالي للمصاريف" : "Total Expenses";
    string netPayableLabel = isArabic ? "الصافي المستحق" : "Net Payable";
    string generatedAtLabel = isArabic ? "تاريخ الإنشاء" : "Generated At";
}

<div class="container mt-4" dir="@(isArabic ? "rtl" : "ltr")">
    <h1 class="mb-4 @(isArabic ? "text-end" : "text-start")">@pageTitle</h1>

    @* Uncomment this form if you want to enable finalizing settlements *@
    @*
    <form asp-action="TechniciansSettlement" method="post" class="mb-4">
        @for (int i = 0; i < Model.Count(); i++)
        {
            <input type="hidden" name="Settlements[@i].TechnicianId" value="@Model.ElementAt(i).TechnicianId" />
            <input type="hidden" name="Settlements[@i].TechnicianName" value="@Model.ElementAt(i).TechnicianName" />
            <input type="hidden" name="Settlements[@i].TotalFromReservations" value="@Model.ElementAt(i).TotalFromReservations" />
            <input type="hidden" name="Settlements[@i].TotalFromInsurance" value="@Model.ElementAt(i).TotalFromInsurance" />
            <input type="hidden" name="Settlements[@i].TotalDebtShare" value="@Model.ElementAt(i).TotalDebtShare" />
            <input type="hidden" name="Settlements[@i].TotalExpenses" value="@Model.ElementAt(i).TotalExpenses" />
            <input type="hidden" name="Settlements[@i].NetPayable" value="@Model.ElementAt(i).NetPayable" />
            <input type="hidden" name="Settlements[@i].GeneratedAt" value="@Model.ElementAt(i).GeneratedAt.ToString("o")" />
            <input type="hidden" name="Settlements[@i].SettlementDate" value="@Model.ElementAt(i).SettlementDate.ToString("yyyy-MM-dd")" />
        }
        <button type="submit" class="btn btn-success">
            <i class="bi bi-check-circle-fill"></i> @finalizeLabel
        </button>
    </form>
    *@

    <table class="table table-bordered table-striped">
        <thead class="table-dark">
            <tr>
                <th>@technicianNameLabel</th>
                <th>@totalFromReservationsLabel</th>
                <th>@totalFromInsuranceLabel</th>
                <th>@totalDebtShareLabel</th>
                <th>@totalExpensesLabel</th>
                <th>@netPayableLabel</th>
                <th>@generatedAtLabel</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td>@Html.DisplayFor(m => item.TechnicianName)</td>
                    <td>@Html.DisplayFor(m => item.TotalFromReservations)</td>
                    <td>@Html.DisplayFor(m => item.TotalFromInsurance)</td>
                    <td>@Html.DisplayFor(m => item.TotalDebtShare)</td>
                    <td>@Html.DisplayFor(m => item.TotalExpenses)</td>
                    <td>@Html.DisplayFor(m => item.NetPayable)</td>
                    <td>@Html.DisplayFor(m => item.GeneratedAt)</td>
                </tr>
            }
        </tbody>
    </table>
</div>
