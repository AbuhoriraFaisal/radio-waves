@model radio_waves.Models.Patient

@{
    var culture = System.Globalization.CultureInfo.CurrentCulture.Name;
    var isArabic = culture.StartsWith("ar");

    ViewData["Title"] = isArabic ? "تعديل مريض" : "Edit Patient";

    string heading = isArabic ? "تعديل مريض" : "Edit Patient";
    string nameLabel = isArabic ? "الاسم الكامل" : "Full Name";
    string phoneLabel = isArabic ? "رقم الهاتف" : "Phone";
    string saveBtn = isArabic ? "حفظ" : "Save";
    string backText = isArabic ? "العودة للقائمة" : "Back to List";
}

<div class="container mt-4" dir="@(isArabic ? "rtl" : "ltr")">
    <h1 class="mb-4 @(isArabic ? "text-end" : "text-start")">@heading</h1>

    <div class="row">
        <div class="col-md-6">
            <form asp-action="Edit">
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>

                <input type="hidden" asp-for="Id" />

                <div class="form-group mb-3">
                    <label asp-for="FullName" class="form-label">@nameLabel</label>
                    <input asp-for="FullName" class="form-control" />
                    <span asp-validation-for="FullName" class="text-danger"></span>
                </div>

                <div class="form-group mb-3">
                    <label asp-for="Phone" class="form-label">@phoneLabel</label>
                    <input asp-for="Phone" class="form-control" />
                    <span asp-validation-for="Phone" class="text-danger"></span>
                </div>

                @* Uncomment if HasInsurance and InsuranceId are used
                <div class="form-check mb-3">
                    <input class="form-check-input" asp-for="HasInsurance" id="hasInsuranceCheckbox" />
                    <label class="form-check-label" for="hasInsuranceCheckbox">
                        @(isArabic ? "هل لديه تأمين؟" : "Has Insurance?")
                    </label>
                </div>

                <div class="form-group mb-3">
                    <label asp-for="InsuranceId" class="form-label">@((isArabic ? "شركة التأمين" : "Insurance Company"))</label>
                    <select asp-for="InsuranceId" asp-items="ViewBag.Insurances" class="form-control" id="insuranceDropdown" disabled>
                        <option value="">@((isArabic ? "-- اختر التأمين --" : "-- Select Insurance --"))</option>
                    </select>
                    <span asp-validation-for="InsuranceId" class="text-danger"></span>
                </div>
                *@

                <div class="form-group">
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-save"></i> @saveBtn
                    </button>
                    <a asp-action="Index" class="btn btn-secondary ms-2">
                        <i class="bi bi-arrow-left-circle"></i> @backText
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }

    <script>
        // Enable insurance dropdown based on checkbox state (if used)
        document.addEventListener("DOMContentLoaded", function () {
            const checkbox = document.getElementById("hasInsuranceCheckbox");
            const dropdown = document.getElementById("insuranceDropdown");

            if (checkbox && dropdown) {
                function toggleDropdown() {
                    dropdown.disabled = !checkbox.checked;
                }

                checkbox.addEventListener("change", toggleDropdown);
                toggleDropdown(); // initial
            }
        });
    </script>
}
